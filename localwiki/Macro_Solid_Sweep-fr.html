<html><head><title>Macro Solid Sweep/fr</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type='text/css' href='wiki.css' rel='stylesheet'></head><body><h1>Macro Solid Sweep/fr</h1></div>

<div id="mw-content-text" lang="fr" dir="ltr" class="mw-content-ltr"><hr/><div class="mw-parser-output"><table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tr>
<td class="ctTitle">
<h3><span class="mw-headline" id="Balayage_solide"><a href="https://www.freecadweb.org/wiki/index.php?title=File:Text-x-python.png" class="image"><img alt="Text-x-python.png" src="32px-Text-x-python.png" width="32" height="32" srcset="/wiki/images/2/2c/Text-x-python.png 1.5x" /></a> Balayage solide</span></h3>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left">Créé un solide en balayant un profil le long d'une trajectoire.
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven"><a href="https://www.freecadweb.org/wiki/index.php?title=User:Normandc" title="User:Normandc">Normandc</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven"><a href="https://www.freecadweb.org/wiki/index.php?title=Macros_recipes/fr" title="Macros recipes/fr">Recettes macros</a><br /><a href="https://www.freecadweb.org/wiki/index.php?title=How_to_install_macros/fr" title="How to install macros/fr">Comment installer une macro</a><br /><a href="https://www.freecadweb.org/wiki/index.php?title=Customize_Toolbars/fr" title="Customize Toolbars/fr">Comment ajouter une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Date dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2011-12-03
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br /><div id="toc" class="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Balayage_solide"><span class="tocnumber">1</span> <span class="toctext">Balayage solide</span></a></li>
<li class="toclevel-1 tocsection-1"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.C3.89l.C3.A9ments_2D_support.C3.A9s"><span class="tocnumber">3</span> <span class="toctext">Éléments 2D supportés</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Conseils"><span class="tocnumber">4</span> <span class="toctext">Conseils</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Le_script"><span class="tocnumber">5</span> <span class="toctext">Le script</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Remerciements"><span class="tocnumber">6</span> <span class="toctext">Remerciements</span></a></li>
</ul>
</div>

</td></tr>
</table>
<p><br />
</p><p>Cette macro créé un solide en balayant un profil le long d'une trajectoire, les deux éléments ayant précédemment été sélectionnés dans la vue 3D. Les éléments 2D peuvent être créés à l'aide des outils existants de l'interface graphique de FreeCAD.
</p><p>Il est à noter que le solide généré ne sera <b>pas</b> paramétrique. Si vous décidez de modifier le profil ou la trajectoire, vous devrez exécuter la macro à nouveau.
</p><p><a href="https://www.freecadweb.org/wiki/index.php?title=File:Solid_sweep.png" class="image" title="Quelques exemples de balayages utilisant une même section oblongue et trois types de trajectoires."><img alt="Quelques exemples de balayages utilisant une même section oblongue et trois types de trajectoires." src="500px-Solid_sweep.png" width="500" height="331" srcset="/wiki/images/thumb/f/fd/Solid_sweep.png/750px-Solid_sweep.png 1.5x, /wiki/images/f/fd/Solid_sweep.png 2x" /></a>
</p>
<h3><span class="mw-headline" id="Utilisation">Utilisation</span></h3>
<ul><li> Créer deux éléments 2D, un pour la section et l'autre pour la trajectoire, selon les types listés ci-dessous.</li>
<li> Sélectionner soit dans l'arborescence de projet, soit dans la vue 3D, en premier lieu la trajectoire, et ensuite la section. Attention, l'ordre de sélection est important!</li>
<li> Ouvrir le gestionnaire Macro, sélectionner la macro et cliquer sur «&#160;Lancer&#160;».</li>
<li> Un objet <b>Balayage</b> sera créé dans l'arborescence de projet.</li></ul>
<h3><span class="mw-headline" id=".C3.89l.C3.A9ments_2D_support.C3.A9s">Éléments 2D supportés</span></h3>
<ul><li> Filaires</li>
<li> <a href="https://www.freecadweb.org/wiki/index.php?title=File:Sketcher_NewSketch.png" class="image"><img alt="Sketcher NewSketch.png" src="32px-Sketcher_NewSketch.png" width="32" height="32" srcset="/wiki/images/thumb/4/46/Sketcher_NewSketch.png/48px-Sketcher_NewSketch.png 1.5x, /wiki/images/4/46/Sketcher_NewSketch.png 2x" /></a> <a href="https://www.freecadweb.org/wiki/index.php?title=Sketcher_Workbench/fr" title="Sketcher Workbench/fr">Esquisses</a></li>
<li> <a href="https://www.freecadweb.org/wiki/index.php?title=File:Draft_BSpline.png" class="image"><img alt="Draft BSpline.png" src="Draft_BSpline.png" width="64" height="64" /></a> <a href="https://www.freecadweb.org/wiki/index.php?title=Draft_BSpline/fr" title="Draft BSpline/fr">BSplines</a></li>
<li> Primitives 2D depuis le menu <i>Pièce → <a href="https://www.freecadweb.org/wiki/index.php?title=File:Part_CreatePrimitives.png" class="image"><img alt="Part CreatePrimitives.png" src="32px-Part_CreatePrimitives.png" width="32" height="32" srcset="/wiki/images/thumb/8/8a/Part_CreatePrimitives.png/48px-Part_CreatePrimitives.png 1.5x, /wiki/images/8/8a/Part_CreatePrimitives.png 2x" /></a> <a href="https://www.freecadweb.org/wiki/index.php?title=Part_CreatePrimitives/fr" title="Part CreatePrimitives/fr">Créer des primitives</a>...</i> (cercle, hélice)</li></ul>
<h3><span class="mw-headline" id="Conseils">Conseils</span></h3>
<ul><li> La section doit être un profil fermé sinon la forme résultante ne sera pas solide.</li>
<li> La section n'a pas besoin d'être située sur la trajectoire, mais il est préférable qu'elle lui soit normale (perpendiculaire).</li>
<li> La trajectoire peut indifféremment être un profil ouvert ou fermé (cercle, ou une suite de segments de lignes et d'arcs) mais tous les éléments doivent être tangents, sinon le résultat pourrait être inattendu. Par exemple, une trajectoire avec des coins carrés comme un rectangle ne produira pas un solide.</li>
<li> S'il y a un nœud dans la forme résultante, modifiez la macro et changez la valeur <i>isFrenet</i> à 0 (zéro), puis essayez à nouveau.</li>
<li> Réglez la variable <i>makeSolid</i> à 0 (zéro) pour obtenir une forme non solide faite de surfaces avec des extrémités ouvertes.</li></ul>
<h3><span class="mw-headline" id="Le_script">Le script</span></h3>
<pre>import Part, FreeCAD, math, PartGui, FreeCADGui
from FreeCAD import Base

# get the selected objects, with first selection for the trajectory and second for the section
s = FreeCADGui.Selection.getSelection()
try:
     shape1=s[0].Shape
     shape2=s[1].Shape
except:
     print "Wrong selection"

traj = Part.Wire([shape1])
section = Part.Wire([shape2])

# create Part objec in the current document
myObject=App.ActiveDocument.addObject("Part::Feature","Sweep")

# variable makeSolid = 1 to create solid, 0 to create surfaces
makeSolid = True #1
isFrenet = True #1

# create a 3D shape and assigh it to the current document
Sweep = Part.Wire(traj).makePipeShell([section],makeSolid,isFrenet)
myObject.Shape = Sweep </pre>
<h3><span class="mw-headline" id="Remerciements">Remerciements</span></h3>
<p>Merci à <a href="https://www.freecadweb.org/wiki/index.php?title=User:Wmayer" title="User:Wmayer">Wmayer</a> sans l'aide de qui je n'aurais pu rédiger ce script.
</p><p>Deux exemples d'utilisation peuvent être consultés dans <a rel="nofollow" class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=8&amp;t=1222&amp;start=50#p11120">cette discussion du forum (en anglais)</a>, ainsi que des liens de téléchargement des fichiers FCStd. En utilisant une hélice comme trajectoire, un balayage solide peut être utilisé pour créer un filet de vis.
</p>
</div>



</div>

</div><div class="printfooter">
Online version: "<a dir="ltr" href="https://www.freecadweb.org/wiki/index.php?title=Macro_Solid_Sweep/fr&amp;oldid=240622">http://www.freecadweb.org/wiki/index.php?title=Macro_Solid_Sweep/fr&amp;oldid=240622</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"></div><div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>

</body></html>