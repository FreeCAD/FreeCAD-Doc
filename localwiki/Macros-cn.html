<html><head><title>Macros/cn</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type='text/css' href='wiki.css' rel='stylesheet'></head><body><h1>Macros/cn</h1></div>

<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>在 FreeCAD 中宏是一种快速进行复杂操作的方便的方式。您简单地录制下操作，保存为某个名字的宏，然后就可以随时重复录制的操作了。因为宏记录的是 python 命令，因此您也可以编辑和创建复杂的宏。
</p>
<div id="toc" class="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E5.AE.8F.E5.A6.82.E4.BD.95.E5.B7.A5.E4.BD.9C"><span class="tocnumber">1</span> <span class="toctext">宏如何工作</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E4.BE.8B.E5.AD.90"><span class="tocnumber">2</span> <span class="toctext">例子</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E4.B8.AA.E6.80.A7.E5.8C.96.E5.AE.9A.E5.88.B6.E5.AE.8F"><span class="tocnumber">3</span> <span class="toctext">个性化定制宏</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E4.B8.8D.E8.AE.B0.E5.BD.95.E8.80.8C.E5.88.9B.E5.BB.BA.E5.AE.8F"><span class="tocnumber">4</span> <span class="toctext">不记录而创建宏</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.E5.AE.8F.E5.BA.93"><span class="tocnumber">5</span> <span class="toctext">宏库</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id=".E5.AE.8F.E5.A6.82.E4.BD.95.E5.B7.A5.E4.BD.9C">宏如何工作</span></h3>
<p>If you enable console output (Menu Edit -&gt; Preferences -&gt; General -&gt; Macros -&gt; Show scripts commands in python console), you will see that in FreeCAD, every action you do, such as pressing a button, outputs a python command. Thos commands are what can be recorded in a macro. The main tool for making macros is the macros toolbar: <a href="https://www.freecadweb.org/wiki/index.php?title=File:Macros_toolbar.jpg" class="image"><img alt="Macros toolbar.jpg" src="Macros_toolbar.jpg" width="144" height="43" /></a>. On it you have 4 buttons: Record, stop recording, edit and play the current macro.
</p><p>It is very simple to use: Press the record button, you will be asked to give a name to your macro, then perform some actions. When you are done, click the stop recording button, and your actions will be saved. You can now access the macro dialog with the edit button:
</p><p><a href="https://www.freecadweb.org/wiki/index.php?title=File:Macros.jpg" class="image"><img alt="Macros.jpg" src="Macros.jpg" width="381" height="408" /></a>
</p><p>There you can manage your macros, delete, edit or create new ones from scratch. If you edit a macro, it will be opened in an editor window where you can make changes to its code.
</p>
<h3><span class="mw-headline" id=".E4.BE.8B.E5.AD.90">例子</span></h3>
<p>Press the record button, give a name, let's say "cylinder 10x10", then, in the <a href="Part_Workbench.html" class="mw-redirect" title="Part Workbench">Part Workbench</a>, create a cylinder with radius = 10 and height = 10. Then, press the "stop recording" button. In the edit macros dialog, you can see the python code that has been recorded, and, if you want, make alterations to it. To execute your macro, simply press the execute button on the toolbar while your macro is in the editor. You macro is always saved to disk, so any change you make, or any new macro you create, will always be available next time you start FreeCAD.
</p>
<h3><span class="mw-headline" id=".E4.B8.AA.E6.80.A7.E5.8C.96.E5.AE.9A.E5.88.B6.E5.AE.8F">个性化定制宏</span></h3>
<p>Of course it is not practical to load a macro in the editor in order to use it. FreeCAD provides much better ways to use your macro, such as assigning a keyboard shortcut to it or putting an entry in the menu. Once your macro is created, all this can be done via the Tools -&gt; Customize menu:
</p><p><a href="https://www.freecadweb.org/wiki/index.php?title=File:Macros_config.jpg" class="image"><img alt="Macros config.jpg" src="Macros_config.jpg" width="400" height="276" /></a>
</p><p>This way you can make your macro become a real tool, just like any standard FreeCAD tool. This, added to the power of python scripting within FreeCAD, makes it possible to easily add your own tools to the interface. Read on to the <a href="Scripting.html" class="mw-redirect" title="Scripting">Scripting</a> page if you want to know more about python scripting...
</p>
<h3><span class="mw-headline" id=".E4.B8.8D.E8.AE.B0.E5.BD.95.E8.80.8C.E5.88.9B.E5.BB.BA.E5.AE.8F">不记录而创建宏</span></h3>
<p>You can also directly copy/paste python code into a macro, without recording GUI action. Simply create a new macro, edit it, and paste your code. You can then save your macro the same way as you save a FreeCAD document. Next time you start FreeCAD, the macro will appear under the "Installed Macros" item of the Macro menu.
</p>
<h3><span class="mw-headline" id=".E5.AE.8F.E5.BA.93">宏库</span></h3>
<p>Visit the <a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a> page to pick some useful macros to add to your FreeCAD installation.
</p>

<p><br />
</p>




</div>

</div><div class="printfooter">
Online version: "<a dir="ltr" href="https://www.freecadweb.org/wiki/index.php?title=Macros/cn&amp;oldid=211443">http://www.freecadweb.org/wiki/index.php?title=Macros/cn&amp;oldid=211443</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"></div><div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>

</body></html>