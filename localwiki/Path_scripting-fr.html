<html><head><title>Path scripting/fr</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type='text/css' href='wiki.css' rel='stylesheet'></head><body><h1>Path scripting/fr</h1></div>

<div id="mw-content-text" lang="fr" dir="ltr" class="mw-content-ltr"><hr/><div class="mw-parser-output"><table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tr>
<td class="ctTitle">
<h3><span class="mw-headline" id="Tutoriel"><a href="https://www.freecadweb.org/wiki/index.php?title=File:Base_ExampleCommandModel.png" class="image"><img alt="Base ExampleCommandModel.png" src="32px-Base_ExampleCommandModel.png" width="32" height="30" srcset="/wiki/images/thumb/9/93/Base_ExampleCommandModel.png/48px-Base_ExampleCommandModel.png 1.5x, /wiki/images/9/93/Base_ExampleCommandModel.png 2x" /></a> Tutoriel</span></h3>
</td></tr>
<tr>
<th class="ctOdd">Tutoriel
</th></tr>
<tr>
<td class="ctEven">Atelier Path
</td></tr>
<tr>
<th class="ctOdd">Niveau
</th></tr>
<tr>
<td class="ctEven">Intermédiaire
</td></tr>
<tr>
<th class="ctOdd">Temps d'exécution estimé
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Version de FreeCAD
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Fichier(s) exemple(s)
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<td class="ctToc"><br /><div id="toc" class="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Tutoriel"><span class="tocnumber">1</span> <span class="toctext">Tutoriel</span></a></li>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">2</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#D.C3.A9marrage_rapide"><span class="tocnumber">3</span> <span class="toctext">Démarrage rapide</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Format_G-Code_interne_de_FreeCAD"><span class="tocnumber">4</span> <span class="toctext">Format G-Code interne de FreeCAD</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#R.C3.A9f.C3.A9rence_GCode"><span class="tocnumber">4.1</span> <span class="toctext">Référence GCode</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Liste_des_commandes_G-Code_actuellement_accept.C3.A9es"><span class="tocnumber">4.2</span> <span class="toctext">Liste des commandes G-Code actuellement acceptées</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#L.27objet_Command"><span class="tocnumber">5</span> <span class="toctext">L'objet Command</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#L.27objet_Path"><span class="tocnumber">6</span> <span class="toctext">L'objet Path</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Caract.C3.A9ristique_de_Path"><span class="tocnumber">7</span> <span class="toctext">Caractéristique de Path</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Objets_Tool_et_Tooltable"><span class="tocnumber">8</span> <span class="toctext">Objets Tool et Tooltable</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Caract.C3.A9ristiques"><span class="tocnumber">9</span> <span class="toctext">Caractéristiques</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Path_Compound"><span class="tocnumber">9.1</span> <span class="toctext">Path Compound</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Path_Project"><span class="tocnumber">9.2</span> <span class="toctext">Path Project</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Path_Shape"><span class="tocnumber">9.3</span> <span class="toctext">Path Shape</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Python"><span class="tocnumber">9.4</span> <span class="toctext">Python</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Importer_et_exporter_du_GCode"><span class="tocnumber">10</span> <span class="toctext">Importer et exporter du GCode</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Format_Natif"><span class="tocnumber">10.1</span> <span class="toctext">Format Natif</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Utiliser_les_scripts_de_pre-_et_post-traitement"><span class="tocnumber">10.2</span> <span class="toctext">Utiliser les scripts de pre- et post-traitement</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#.C3.89crire_des_scripts_de_traitement"><span class="tocnumber">10.3</span> <span class="toctext">Écrire des scripts de traitement</span></a></li>
</ul>
</li>
</ul>
</div>

</td></tr></table>
<p><br /> 
</p>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>L'atelier Path propose des outils pour importer, créer, manipuler et exporter des <a rel="nofollow" class="external text" href="https://fr.wikipedia.org/wiki/Programmation_de_commande_num%C3%A9rique">parcours-outils</a> dans FreeCAD. Avec eux, l'utilisateur peut importer, voir et modifier des programmes G-Code existants, créer des chemins d'outils depuis des formes 3D et exporter ces chemins d'outils vers G-Code.
</p><p>À l'heure actuelle, l'atelier Path est encore au début de son développement et ne peut pas encore vous proposer  les fonctionnalités avancées de certains logiciels commerciaux. Néanmoins, son interface de script pour python vous facilite les modifications ou le développement d'outils plus puissants et est, pour l'instant, plus destiné aux utilisateurs avec des connaissances en scripts python qu'aux utilisateurs finaux.
</p><p>Ci-dessous, vous trouverez une description plus approfondie de l'API de script python.
</p>
<h2><span class="mw-headline" id="D.C3.A9marrage_rapide">Démarrage rapide</span></h2>
<p>Les objets Path de FreeCAD Path sont des commandes de séquences de déplacement. Voici une utilisation typique:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Path
    >>> c1 = Path.Command("g1x1")
    >>> c2 = Path.Command("g1y4")
    >>> c3 = Path.Command("g1 x2 y2") # spaces end newlines are not considered
    >>> p = Path.Path([c1,c2,c3])
    >>> o = App.ActiveDocument.addObject("Path::Feature","mypath")
    >>> o.Path = p
    >>> print p.toGCode()</pre></div>
<h2><span class="mw-headline" id="Format_G-Code_interne_de_FreeCAD">Format G-Code interne de FreeCAD</span></h2>
<p>Un concept préliminaire est important à appréhender. La plus grande partie de l'implémentation ci-dessous est fortement liée aux commandes de déplacement qui ont les même noms que ceux de G-Code mais sans être proche d'une implémentation spécifique à un contrôleur. Nous avons choisi des noms tels que «&#160;G0&#160;» pour indiquer un mouvement «&#160;rapide&#160;» ou «&#160;G1&#160;» pour un déplacement «&#160;d'alimentation&#160;» pour la performance (sauvegarde de fichier efficace) et pour minimiser le travail de traduction de et vers les autres formats G-Code. Puisque le monde de la CNC utilise des milliers de dialectes G-Code, nous avons choisi de rester avec une partie simplifiée de ce code. On pourrait décrire le format G-Code de FreeCAD comme une forme indépendante des machines.
</p><p>Les données Path sont sauvegardées directement sous cette forme de G-Code dans les fichiers .FCStd
</p><p>Toutes les traductions de et vers des dialectes G-Code FreeCAD sont réalisées par des scripts pre et post. Cela signifie que si vous voulez travailler avec une machine qui utilise un contrôleur spécifique tel que LinuxCNC, Fanuc, Mitusubishi, ou HAAS, etc., vous devrez utiliser (ou écrire s'il n'existe pas) un post-processeur pour ce contrôleur spécifique (allez voir la section «&#160;Importer et exporter du G-Code&#160;» ci-dessous).
</p>
<h3><span class="mw-headline" id="R.C3.A9f.C3.A9rence_GCode">Référence GCode</span></h3>
<p>Les règles et les lignes directrices suivantes définissent le jeu de G-Code employé en interne dans FreeCAD:
</p>
<ul><li> la donnée G-Code, dans les objets Path de FreeCAD, est séparée en «&#160;Commandes&#160;». Une Commande est définie par un nom qui doit débuter par G ou M et (optionnellement) des arguments, qui sont sous la forme Lettre = Nombre Flottant, par exemple X 0.02 ou Y 3.5 ou F 300. Ce sont des exemples typiques de commandes G-Code de FreeCAD:</li></ul>
<pre>   G0 X2.5 Y0 (le nom de commande est G0, les arguments X=2.5 et Y=0)
</pre>
<pre>   G1 X30 (le nom de commande est G1, le seul argument  X=30)
</pre>
<pre>   G90 (le nom de commande est G90, sans argument)
</pre>
<ul><li> Pour la partie numérique d'une commande G ou M, les deux formes «&#160;G1&#160;» ou «&#160;G01&#160;» sont acceptées.</li>
<li> Seules les commandes débutant par G ou M sont actuellement acceptées pour l'instant.</li>
<li> Seuls les millimètres sont acceptés pour le moment. G20/G21 ne sont pas pris en compte.</li>
<li> Les arguments sont toujours triés alphabétiquement. Cela signifie que si vous créez une commande «&#160;G1 X2 Y4 F300&#160;», elle sera écrite comme «&#160;G1 F300 X2 Y4&#160;».</li>
<li> Les arguments ne peuvent pas être répétés dans une même commande. Par exemple, «&#160;G1 X1 Y2 X2 Y3&#160;» ne fonctionnera pas. Vous devrez la séparer en deux, par exemple: «&#160;G1 X1 Y2, G1 X2 Y3&#160;».</li>
<li> Les arguments X, Y, Z, A, B, C sont absolus ou relatifs, en fonction du mode G90/G91 actuel. C'est par défaut  à absolu (si ce n'est pas spécifié).</li>
<li> I, J, K sont toujours relatifs au dernier point. K peut être oublié.</li>
<li> X, Y, ou Z (et A, B, C) peuvent être oubliés. Dans ce cas, les coordonnées X, Y ou Z précédentes sont gardées.</li>
<li> Les commandes G-code autres que celles listées dans la table ci-dessous sont supportées, ceci étant, elles sont sauvegardées dans le path data (tant qu'elles satisfont aux règles ci-dessus, bien sûr), mais elle ne produiront tout simplement pas de résultat visible à l'écran. Par exemple, vous pouvez ajouter la commande G81, elle sera enregistrée mais pas affichée.</li></ul>
<h3><span class="mw-headline" id="Liste_des_commandes_G-Code_actuellement_accept.C3.A9es">Liste des commandes G-Code actuellement acceptées</span></h3>
<table>
<tr>
<th>Commande
</th>
<th>Description
</th>
<th>Arguments acceptés
</th></tr>
<tr>
<td>G0
</td>
<td>déplacement rapide
</td>
<td>X,Y,Z,A,B,C
</td></tr>
<tr>
<td>G1
</td>
<td>déplacement normal
</td>
<td>X,Y,Z,A,B,C
</td></tr>
<tr>
<td>G2
</td>
<td>arc dans le sens des aiguilles
</td>
<td>X,Y,Z,A,B,C,I,J,K
</td></tr>
<tr>
<td>G3
</td>
<td>arc inverse du sens des aiguilles
</td>
<td>X,Y,Z,A,B,C,I,J,K
</td></tr>
<tr>
<td>G81, G82, G83
</td>
<td>perçage
</td>
<td>X,Y,Z,R,Q
</td></tr>
<tr>
<td>G90
</td>
<td>coordonnées absolues
</td>
<td>
</td></tr>
<tr>
<td>G91
</td>
<td>coordonnées relatives
</td>
<td>
</td></tr>
<tr>
<td>(Message)
</td>
<td>commentaire
</td>
<td>
</td></tr></table>
<h2><span class="mw-headline" id="L.27objet_Command">L'objet Command</span></h2>
<p>L'objet Command représente une commande gcode. Il a trois attributs: Nom, Paramètres et Placement, ainsi que deux méthodes: toGCode() et setFromGCode(). En interne, il ne contient qu'un nom et un dictionnaire de paramètres. La suite (placement et gcode) est interprétée depuis/vers ces données.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Path
    >>> c=Path.Command()
    >>> c
    Command  ( )
    >>> c.Name = "G1"
    >>> c
    Command G1 ( )
    >>> c.Parameters= {"X":1,"Y":0}
    >>> c
    Command G1 ( X:1 Y:0 )
    >>> c.Parameters
    {'Y': 0.0, 'X': 1.0}
    >>> c.Parameters= {"X":1,"Y":0.5}
    >>> c
    Command G1 ( X:1 Y:0.5 )
    >>> c.toGCode()
    'G1X1Y0.5'
    >>> c2=Path.Command("G2")
    >>> c2
    Command G2 ( )
    >>> c3=Path.Command("G1",{"X":34,"Y":1.2})
    >>> c3
    Command G1 ( X:34 Y:1.2 )
    >>> c3.Placement
    Placement [Pos=(34,1.2,0), Yaw-Pitch-Roll=(0,0,0)]
    >>> c3.toGCode()
    'G1X34Y1.2'
    >>> c3.setFromGCode("G1X1Y0")
    >>> c3
    Command G1 [ X:1 Y:0 ]
    >>> c4 = Path.Command("G1X4Y5")
    >>> c4
    Command G1 [ X:4 Y:5 ]
    >>> p1 = App.Placement()
    >>> p1.Base = App.Vector(3,2,1)
    >>> p1
    Placement [Pos=(3,2,1), Yaw-Pitch-Roll=(0,0,0)]
    >>> c5=Path.Command("g1",p1)
    >>> c5
    Command G1 [ X:3 Y:2 Z:1 ]
    >>> p2=App.Placement()
    >>> p2.Base = App.Vector(5,0,0)
    >>> c5
    Command G1 [ X:3 Y:2 Z:1 ]
    >>> c5.Placement=p2
    >>> c5
    Command G1 [ X:5 ]
    >>> c5.x
    5.0
    >>> c5.x=10
    >>> c5
    Command G1 [ X:10 ]
    >>> c5.y=2
    >>> c5
    Command G1 [ X:10 Y:2 ]</pre></div>
<h2><span class="mw-headline" id="L.27objet_Path">L'objet Path</span></h2>
<p>L'objet Path contient une liste de commandes.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Path
    >>> c1=Path.Command("g1",{"x":1,"y":0})
    >>> c2=Path.Command("g1",{"x":0,"y":2})
    >>> p=Path.Path([c1,c2])
    >>> p
    Path [ size:2 length:3 ]
    >>> p.Commands
    [Command G1 [ X:1 Y:0 ], Command G1 [ X:0 Y:2 ]]
    >>> p.Length
    3.0
    >>> p.addCommands(c1)
    Path [ size:3 length:4 ]
    >>> p.toGCode()
    'G1X1G1Y2G1X1'
    
    lines = """
    G0X-0.5905Y-0.3937S3000M03
    G0Z0.125
    G1Z-0.004F3
    G1X0.9842Y-0.3937F14.17
    G1X0.9842Y0.433
    G1X-0.5905Y0.433
    G1X-0.5905Y-0.3937
    G0Z0.5
    """
    
    slines = lines.split('\n')
    p = Path.Path()
    for line in slines:
        p.addCommands(Path.Command(line))
    
    o = App.ActiveDocument.addObject("Path::Feature","mypath")
    o.Path = p
    
    # but you can also create a path directly form a piece of gcode.
    # The commands will be created automatically:
    
    p = Path.Path()
    p.setFromGCode(lines)</pre></div>
<p>En simplifiant, un objet Path peut aussi être créé directement depuis une séquence G-Code complète. Elle sera automatiquement divisée en séquences de commandes.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> p = Path.Path("G0 X2 Y2 G1 X0 Y2")
    >>> p
    Path [ size:2 length:2 ]</pre></div>
<h2><span class="mw-headline" id="Caract.C3.A9ristique_de_Path">Caractéristique de Path</span></h2>
<p>Path est un objet document de FreeCAD, qui contient un chemin et le présente en une vue 3D.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> pf = App.ActiveDocument.addObject("Path::Feature","mypath")
    >>> pf
    &lt;Document object>
    >>> pf.Path = p
    >>> pf.Path
    Path [ size:2 length:2 ]</pre></div>
<p>Path contient aussi une propriété de Placement. Changer la valeur de ce placement modifiera la position dans la vue 3D, bien que l'information Path elle-même, ne soit pas modifiée. La transformation est purement visuelle. Cela vous permet, par exemple, de créer un Path autour d'une face qui a une orientation particulière sur votre modèle, qui n'aura pas la même orientation que la matière première que vous positionnerez sur votre CNC.
</p><p>Néanmoins, Path Compounds peut utiliser le Placement de ses enfants (voir ci-dessous).
</p>
<h2><span class="mw-headline" id="Objets_Tool_et_Tooltable">Objets Tool et Tooltable</span></h2>
<p>L'objet Tool contient les définitions d'un outil de CNC. L'objet Tooltable contient, lui, une liste ordonnée d'outils. Les Tooltables sont reliées comme propriété dans les caractérisques de Path Project et peuvent donc être éditées par l'interface graphique en double-cliquant sur le bouton «&#160;Edit tooltable&#160;» de l'arborescence d'un projet dans les tâches qui s'ouvrent.
</p><p>Les tables d'outils peuvent être importées depuis les .xml de FreeCAD et les formats .tooltable de HeeksCad et exportés au format .xml de FreeCAD depuis cette interface.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Path
    >>> t1=Path.Tool()
    >>> t1
    Tool Default tool
    >>> t1.Name = "12.7mm Drill Bit"
    >>> t1
    Tool 12.7mm Drill Bit
    >>> t1.ToolType
    'Undefined'
    >>> t1.ToolType = "Drill"
    >>> t1.Diameter= 12.7
    >>> t1.LengthOffset = 127
    >>> t1.CuttingEdgeAngle = 59
    >>> t1.CuttingEdgeHeight = 50.8
    >>> t2 = Path.Tool("my other tool",tooltype="EndMill",diameter=10)
    >>> t2
    Tool my other tool
    >>> t2.Diameter
    10.0
    >>> table = Path.Tooltable()
    >>> table
    Tooltable containing 0 tools
    >>> table.addTools(t1)
    Tooltable containing 1 tools
    >>> table.addTools(t2)
    Tooltable containing 2 tools
    >>> table.Tools
    {1: Tool 12.7mm Drill Bit, 2: Tool my other tool}
    >>></pre></div>
<h2><span class="mw-headline" id="Caract.C3.A9ristiques">Caractéristiques</span></h2>
<h3><span class="mw-headline" id="Path_Compound">Path Compound</span></h3>
<p>L'objectif de cette fonction est d'assembler un ou plusieurs chemins d'outils et l'(les) associer à une table d'outils. La fonction Compound se comporte aussi comme un groupe standard FreeCAD dont vous pouvez y ajouter ou y enlever les objets directement depuis la vue arborescente. Vous pouvez aussi réordonner les items en double-cliquant sur l'objet Compound de la vue arborescente et réordonner ses élements dans la vue de Taches qui s'ouvre.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Path
    >>> p1 = Path.Path("G1X1")
    >>> o1 = App.ActiveDocument.addObject("Path::Feature","path1")
    >>> o1.Path=p1
    >>> p2 = Path.Path("G1Y1")
    >>> o2 = App.ActiveDocument.addObject("Path::Feature","path2")
    >>> o2.Path=p2
    >>> o3 = App.ActiveDocument.addObject("Path::FeatureCompound","compound")
    >>> o3.Group=[o1,o2]</pre></div>
<p>Une caractéristique importante de Path Compounds est la possibilité de prendre en compte ou non  le Placement des sous-chemins en cochant leur propriété UsePlacements à True ou False. Sans cela, les données Path des sous-chemins seront simplement ajoutées séquentiellement. Si c'est positionné sur True, chaque commande des sous-chemins, s'ils contiennent des informations de position (G0, G1, etc..), seront d'abord transformés par Placement avant d'être ajoutés.
</p><p>En créant un composant avec un seul sous-chemin, vous pouvez donc de rendre le Placement du sous-chemin «&#160;réel&#160;» (il affecte les données Path).
</p>
<h3><span class="mw-headline" id="Path_Project">Path Project</span></h3>
<p>Le projet Path est une sorte d'extension de Compound, qui possède quelques propriétés liées à la machine telle que tooltable. Il a principalement été créé pour être le type d'objet à exporter en gcode une fois que la totalité de l'initialisation du chemin est prête. L'objet Project est maintenant codé en python, d'où un mécanisme de création un peu différent:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> from PathScripts import PathProject
    >>> o4 = App.ActiveDocument.addObject("Path::FeatureCompoundPython","prj")
    >>> PathProject.ObjectPathProject(o4)
    >>> o4.Group = [o3]
    >>> o4.Tooltable
    Tooltable containing 0 tools</pre></div>
<p>Le module Path propose aussi un éditeur graphique de table d'outils qui peut être appelé depuis python, en lui donnant un objet qui possède une propriété ToolTable:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> from PathScripts import TooltableEditor
    >>> TooltableEditor.edit(o4)</pre></div>
<h3><span class="mw-headline" id="Path_Shape">Path Shape</span></h3>
<p>Cette fonctionnalité est un objet Path normal avec une propriété Shape additionnelle. En donnant à cette propriété une forme Wire, son chemin sera automatiquement calculé à partir de sa forme. Notez que dans ce cas, le placement est positionné automatiquement sur le premier point du fil et l'objet n'est donc plus déplaçable en changeant sa position. Pour le déplacer, la forme sous-jacente doit être bougée.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    >>> import Part
    >>> v1 = FreeCAD.Vector(0,0,0)
    >>> v2 = FreeCAD.Vector(0,2,0)
    >>> v3 = FreeCAD.Vector(2,2,0)
    >>> v4 = FreeCAD.Vector(3,3,0)
    >>> wire = Part.makePolygon([v1,v2,v3,v4])
    >>> o = FreeCAD.ActiveDocument.addObject("Path::FeatureShape","myPath2")
    >>> o.Shape = wire
    >>> FreeCAD.ActiveDocument.recompute()</pre></div>
<h3><span class="mw-headline" id="Python">Python</span></h3>
<p>Les fonctions Path::Feature et Path::FeatureShape ont une version en python, appelées respectivement Path::FeaturePython et Path::FeatureShapePython, qui peuvent être utilisées pour créer des objets paramétriques dérivés plus avancés.
</p>
<h2><span class="mw-headline" id="Importer_et_exporter_du_GCode">Importer et exporter du GCode</span></h2>
<h3><span class="mw-headline" id="Format_Natif">Format Natif</span></h3>
<p>Les fichiers G-Code peuvent être directement importés et exportés par l'interface graphique, en utilisant les éléments du menu «&#160;open&#160;», «&#160;insert&#160;» ou «&#160;export&#160;». Après la saisie du nom de fichier, une fenêtre de dialogue apparaît pour demander quel script de traitement doit être utilisé. Cela peut être fait depuis python:
</p><p>Les informations de Path sont stockées dans des objets Path utilisants le jeu gcode décrit dans la section «&#160;format G-Code interne de FreeCAD&#160;» ci-dessus. Ce jeu peut être importé ou exporté «&#160;tel quel&#160;» ou converti vers/depuis une version spécifique de G-Code adapté à votre machine.
</p><p>Si vous avez un programme G-Code très simple et standard, qui respecte les règles décrites dans la section «&#160;format G-Code interne de FreeCAD&#160;» ci-dessus, par exemple le boomerang de <a rel="nofollow" class="external free" href="http://www.cnccookbook.com/GWESampleFiles.html">http://www.cnccookbook.com/GWESampleFiles.html</a>, il peut être importé directement dans un objet Path, sans traduction (c'est la même chose qu'utiliser l'option «&#160;None&#160;» de l'invite graphique):
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    import Path
    f = open("/path/to/boomerangv4.ncc")
    s = f.read()
    p = Path.Path(s)
    o = App.ActiveDocument.addObject("Path::Feature","boomerang")
    o.Path = p</pre></div>
<p>De même, vous pouvez obtenir l'information path comme un G-Code «&#160;indépendant&#160;» et le sauvegarder manuellement dans un fichier:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    text = o.Path.toGCode()
    print text
    myfile = open("/path/to/newfile.ngc")
    myfile.write(text)
    myfile.close()</pre></div>
<p>Si vous avez besoin d'une sortie adaptée, vous aurez alors besoin de convertir ce G-Code «&#160;indépendant&#160;» dans un format adapté à votre machine. C'est le travail des scripts de post-traitement.
</p>
<h3><span class="mw-headline" id="Utiliser_les_scripts_de_pre-_et_post-traitement">Utiliser les scripts de pre- et post-traitement</span></h3>
<p>Si vous avez un fichier G-Code écrit pour une machine spécifique, qui ne respecte pas les règles internes utilisées de FreeCAD, décrites dans la section «&#160;format G-Code interne de FreeCAD&#160;» ci-dessus, il pourrait échouer à l'import et/ou ne pas être correctement affiché en 3D. Pour y remédier, vous pouvez utiliser un scrit de pré-traitement qui convertira le format spécifique de votre machine vers celui de FreeCAD.
</p><p>Si vous connaissez le nom du script de pré-traitement, vous pouvez importer votre fichier en l'utilisant, depuis la console python de cette manière:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    import example_pre
    example_pre.insert("/path/to/myfile.ncc","DocumentName")</pre></div>
<p>De la même manière, vous pouvez sortir un objet Path vers G-Code, en utilisant un script de post-traitement comme ceci:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    import example_post
    example_post.export (myObjectName,"/path/to/outputFile.ncc")</pre></div>
<h3><span class="mw-headline" id=".C3.89crire_des_scripts_de_traitement">Écrire des scripts de traitement</span></h3>
<p>Les scripts de pré- et post-traitement se comportent comme d'autres importateurs/exportateurs habituels de FreeCAD. Lors du choix d'un script de pré/post traitement depuis l'invite, le processus d'import/export sera redirigé vers le script spécifique donné. Les scripts de pré-traitement doivent contenir au moins des méthodes open(filename) et insert(filename,docname).  Les scripts de post-traitement doivent implémenter export(objectslist,filename).
</p><p>Les scripts sont placés soit dans le répertoire Mod/Path/PathScripts soit dans le répertoire path macro de l'utilisateur. Vous pouvez leur donner le nom que vous voulez mais par convention et pour être utilisé dans les menus de l'interface graphique, les noms des scripts de pré-traitement doivent terminer par «&#160;_pre&#160;», les scripts de post-traitement avec «&#160;_post&#160;» (assurez-vous d'utiliser underscore et pas le trait-d'union, sinon python ne pourra pas les importer). Voici un exemple de pré-traitement très, très simple. Des exemple plus complexes peuvent être trouvés dans le répertoire Mod/Path/PathScripts:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>    def open(filename):
        gfile = __builtins__.open(filename)
        inputstring = gfile.read()
        # the whole gcode program will come in as one string,
        # for example: "G0 X1 Y1\nG1 X2 Y2"
        output = ""
        # we add a comment
        output += "(This is my first parsed output!)\n"
        # we split the input string by lines
        lines = inputstring.split("\n")
        for line in lines:
            output += line
            # we must insert the "end of line" character again
            # because the split removed it
            output += "\n"
        # another comment
        output += "(End of program)"
        import Path
        p = Path.Path(output)
        myPath = FreeCAD.ActiveDocument.addObject("Path::Feature","Import")
        myPath.Path = p
        FreeCAD.ActiveDocument.recompute()</pre></div>
<p>Les pré- et post-traitements travaillent exactement de la même manière. Ils font simplement le contraire: les scripts pré convertissent un G-Code spécifique vers le G-Code de FreeCAD, alors que les scripts post convertissent le G-Code de FreeCAD vers un G-Code spécifique à une machine.
</p><p><br />
</p>
<div style="clear:both"></div>
</div>



</div>

</div><div class="printfooter">
Online version: "<a dir="ltr" href="https://www.freecadweb.org/wiki/index.php?title=Path_scripting/fr&amp;oldid=231929">http://www.freecadweb.org/wiki/index.php?title=Path_scripting/fr&amp;oldid=231929</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"></div><div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>

</body></html>