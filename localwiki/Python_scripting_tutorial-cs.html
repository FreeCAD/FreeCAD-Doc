<html><head><title>Python scripting tutorial/cs</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type='text/css' href='wiki.css' rel='stylesheet'></head><body><h1>Python scripting tutorial/cs</h1></div>

<div id="mw-content-text" lang="cs" dir="ltr" class="mw-content-ltr"><hr/><div class="mw-parser-output"><table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tr>
<td class="ctTitle">
<h3><span class="mw-headline" id="Tutorial"><a href="https://www.freecadweb.org/wiki/index.php?title=File:Base_ExampleCommandModel.png" class="image"><img alt="Base ExampleCommandModel.png" src="32px-Base_ExampleCommandModel.png" width="32" height="30" srcset="/wiki/images/thumb/9/93/Base_ExampleCommandModel.png/48px-Base_ExampleCommandModel.png 1.5x, /wiki/images/9/93/Base_ExampleCommandModel.png 2x" /></a> Tutorial</span></h3>
</td></tr>
<tr>
<th class="ctOdd">Topic
</th></tr>
<tr>
<td class="ctEven">Programming
</td></tr>
<tr>
<th class="ctOdd">Level
</th></tr>
<tr>
<td class="ctEven">Intermediate
</td></tr>
<tr>
<th class="ctOdd">Time to complete
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">FreeCAD version
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Example File(s)
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<td class="ctToc"><br /><div id="toc" class="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Tutorial"><span class="tocnumber">1</span> <span class="toctext">Tutorial</span></a></li>
<li class="toclevel-1 tocsection-1"><a href="#Writing_python_code"><span class="tocnumber">2</span> <span class="toctext">Writing python code</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Exploring_FreeCAD"><span class="tocnumber">3</span> <span class="toctext">Exploring FreeCAD</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Vectors_and_Placements"><span class="tocnumber">4</span> <span class="toctext">Vectors and Placements</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#App_and_Gui"><span class="tocnumber">5</span> <span class="toctext">App and Gui</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Modules"><span class="tocnumber">6</span> <span class="toctext">Modules</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Mesh"><span class="tocnumber">7</span> <span class="toctext">Mesh</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Part"><span class="tocnumber">8</span> <span class="toctext">Part</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Draft"><span class="tocnumber">9</span> <span class="toctext">Draft</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Interface"><span class="tocnumber">10</span> <span class="toctext">Interface</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="Macros.html"><span class="tocnumber">11</span> <span class="toctext">Macros</span></a></li>
</ul>
</div>

</td></tr></table>
<p><br /> 
</p><p><br />
<a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Python_%28programming_language%29">Python</a> is a programming language, very simple to use and very fast to learn. It is open-source, multi-platform, and can be used alone for a wide array of things, from programming simple shell scripts to very complex programs. But one of its most widespread uses is as a scripting language, since it is easy to embed in other applications. That's exactly how it is used inside FreeCAD. From the python console, or from your custom scripts, you can pilot FreeCAD, and make it perform very complex actions for which there is still no graphical user interface tool.
</p><p>For example, from a python script, you can:
</p>
<ul><li> create new objects</li>
<li> modify existing objects</li>
<li> modify the 3D representation of those objects</li>
<li> modify the FreeCAD interface</li></ul>
<p>There are also several different ways to use python in FreeCAD:
</p>
<ul><li> From the <a href="FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics">FreeCAD python interpreter</a>, where you can issue simple commands like in a "command line"-style interface</li>
<li> From <a href="Macros.html" title="Macros">macros</a>, which are a convenient way to quickly add a missing tool to the FreeCAD interface</li>
<li> From external scripts, which can be used to program much more complex things. like entire <a href="Workbenches.html" title="Workbenches">Workbenches</a>.</li></ul>
<p>In this tutorial, we'll work on a couple of simple examples to get you started, but there is also much more <a href="https://www.freecadweb.org/wiki/index.php?title=Power_users_hub" title="Power users hub">documentation about python scripting</a> available on this wiki. If you are totally new to python and want to understand how it works, we also have a basic <a href="Introduction_to_Python.html" title="Introduction to Python">introduction to Python</a>.
</p><p><b>Important!</b> Before proceeding with Python scripting, go to <b>Edit-&gt;Prefences-&gt;General-&gt;Output</b> window and check 2 boxes:
</p>
<ul><li> Redirect internal Python output to report view</li>
<li> Redirect internal Python errors to report view</li></ul>
<p>Then go to <b>View-&gt;Panels</b> and check:
</p>
<ul><li> Report view</li></ul>
<p>This will save you a lot of aggravation!
</p>
<h2><span class="mw-headline" id="Writing_python_code">Writing python code</span></h2>
<p>There are two easy ways to write python code in FreeCAD: From the python console (available from the View -&gt; Panels -&gt; Python console menu) or from the Macro editor (Tools -&gt; Macros). In the console, you write python commands one by one, which are executed when you press return, while the macros can contain a more complex script made of several lines, which is executed only when the macro is executed.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:616px;"><a href="https://www.freecadweb.org/wiki/index.php?title=File:Screenshot_pythoninterpreter.jpg" class="image"><img alt="" src="Screenshot_pythoninterpreter.jpg" width="614" height="228" class="thumbimage" /></a>  <div class="thumbcaption">The FreeCAD python console</div></div></div></div>
<p>In this tutorial, you will be able to use both methods, either by copying/pasting each line one by one in the python console and pressing <span style="background: #DDDDDD; border: 1px solid #888888; padding: 0px 5px 1px 5px;">Return</span> after each line, or by copying/pasting the entire code in a new Macro window.
</p>
<h2><span class="mw-headline" id="Exploring_FreeCAD">Exploring FreeCAD</span></h2>
<p>Let's start by creating a new empty document:
</p>
<pre>doc = FreeCAD.newDocument() </pre>
<p>If you type this in the FreeCAD python console, you will notice that as soon as you type "FreeCAD.", a windows pops up, allowing to quickly autocomplete the rest of your line. Even better, each entry in the autocomplete list has a tooltip explaining what it does. This makes it very easy to explore the functionality available. Before choosing "newDocument", have a look at the other options available.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:616px;"><a href="https://www.freecadweb.org/wiki/index.php?title=File:Screenshot_classbrowser.jpg" class="image"><img alt="" src="Screenshot_classbrowser.jpg" width="614" height="228" class="thumbimage" /></a>  <div class="thumbcaption">The autocomplete mechanism of the FreeCAD python console</div></div></div></div>
<p>Now our new document will be created. This is similar to pressing the "new document" button on the toolbar. In fact, most buttons in FreeCAD do nothing else than executing a line or two of python code. Even better, you can set an option in <b>Edit-&gt;Preferences-&gt;General-&gt;Macro</b> to "show script commands in python console". This will print in the console all python code executed when you press buttons. Very useful to learn how to reproduce actions in python.
</p><p>Now let's get back to our document. Let's see what we can do with it:
</p>
<pre>doc. </pre>
<p>Explore the available options. Usually names that begin with a capital letter are attributes, they contain a value, while names that begin with small letter are functions (also called methods), they "do something". Names that begin with an underscore are usually there for the internal working of the module, and you shouldn't care about them. Let's use one of the methods to add a new object to our document:
</p>
<pre>box = doc.addObject("Part::Box","myBox") </pre>
<p>Nothing happens. Why? Because FreeCAD is made for the big picture. One day, it will work with hundreds of complex objects, all depending one from another. Making a small change somewhere could have a big impact, you may need to recalculate the whole document, which could take a long time... For that reason, almost no command updates the scene automatically. You must do it manually:
</p>
<pre>doc.recompute() </pre>
<p>See? Now our box appeared! Many of the buttons that add objects in FreeCAD actually do 2 things: add the object, and recompute. If you turned on the "show script commands in python console" option above, try now adding a sphere with the GUI button, you'll see the two lines of python code being executed one after the other.
</p><p>What about the "Part::Box" will you ask? How can I know what other kind of objects can be added? It's all here:
</p>
<pre>doc.supportedTypes() </pre>
<p>Now let's explore the contents of our box:
</p>
<pre>box. </pre>
<p>You'll immediately see a couple of very interesting things such as:
</p>
<pre>box.Height </pre>
<p>This will print the current height of our box. Now let's try to change that:
</p>
<pre>box.Height = 5 </pre>
<p>If you select your box with the mouse, you'll see that in the properties panel, in the "Data" tab, our "Height" property appears. All properties of a FreeCAD object that appear there (and also in the "View" tab, more about that later), are directly accessible by python too, by their names, like we did with the "Height" property. Try changing the other dimensions of that box.
</p>
<h2><span class="mw-headline" id="Vectors_and_Placements">Vectors and Placements</span></h2>
<p><a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Euclidean_vector">Vectors</a> are a very fundamental concept in any 3D application. It is a list of 3 numbers (x, y and z), describing a point or position in the 3D space. A lot of things can be done with vectors, such as additions, subtractions, projections and <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Vector_space">much more</a>. In FreeCAD vectors work like this:
</p>
<pre>myvec = FreeCAD.Vector(2,0,0)
myvec
myvec.x
myvec.y
othervec = FreeCAD.Vector(0,3,0)
sumvec = myvec.add(othervec) </pre>
<p>Another common feature of FreeCAD objects is their <a href="Placement.html" title="Placement">placement</a>. Each object has a Placement attributes, which contains the position (Base) and orientation (Rotation) of the object. It is easy to manipulate, for example to move our object:
</p>
<pre>box.Placement
box.Placement.Base
box.Placement.Base = sumvec
 
otherpla = FreeCAD.Placement()
box.Placement = otherpla </pre>
<p>Now you must understand a couple of important concepts before we get further.
</p>
<h2><span class="mw-headline" id="App_and_Gui">App and Gui</span></h2>
<p>FreeCAD is made from the beginning to work as a command-line application, without its user interface. As a result, almost everything is separated between a "geometry" component and a "visual" component. When you work in command-line mode, the geometry part is present, but all the visual part is simply disabled. Almost any object in FreeCAD therefore is made of two parts, an Object and a ViewObject.
</p><p>To illustrate the concept, see our cube object, the geometric properties of the cube, such as its dimensions, position, etc... are stored in the object, while its visual properties, such as its color, line thickness, etc... are stored in the viewobject. This corresponds to the "Data" and "View" tabs in the property window. The view object of an object is accessed like this:
</p>
<pre>vo = box.ViewObject </pre>
<p>Now you can also change the properties of the "View" tab:
</p>
<pre>vo.Transparency = 80
vo.hide()
vo.show() </pre>
<p>When you start FreeCAD, the python console already loads 2 base modules: FreeCAD and FreeCADGui (which can also be accessed by their shortcuts App and Gui). They contain all kinds of generic functionality to work with documents and their objects. To illustrate our concept, see that both FreeCAD and FreeCADGui contain an ActiveDocument attribute, which is the currently opened document. FreeCAD.ActiveDocument and FreeCADGui.ActiveDocument are not the same object. They are the two components of a FreeCAD document, and they contain different attributes and methods. For example, FreeCADGui.ActiveDocument contains ActiveView, which is the currently opened 3D view
</p>
<h2><span class="mw-headline" id="Modules">Modules</span></h2>
<p>Now, you must be wondering, what, other than "Part::Box", can I do? The FreeCAD base application is more or less an empty container. Without its modules, it can do little more than create new, empty documents. The true power of FreeCAD is in its faithful modules. Each of them adds not only new workbenches to the interface, but also new python commands and new object types. As a result, several different or even totally incompatible object types can coexist in the same document. The most important modules in FreeCAD, that we'll look at in this tutorial, are <a href="Part_Module.html" title="Part Module">Part</a>, <a href="Mesh_Module.html" class="mw-redirect" title="Mesh Module">Mesh</a>, <a href="Sketcher_Workbench.html" title="Sketcher Workbench">Sketcher</a> or <a href="Draft_Module.html" title="Draft Module">Draft</a>.
</p><p><a href="Sketcher_Workbench.html" title="Sketcher Workbench">Sketcher</a> and <a href="Draft_Module.html" title="Draft Module">Draft</a> both use the <a href="Part_Module.html" title="Part Module">Part</a> module to create and handle their geometry, which are BRep while <a href="Mesh_Module.html" class="mw-redirect" title="Mesh Module">Mesh</a> is totally independent, and handles its own objects. More about that below.
</p><p>You can check all the available base object types for the current document like this:
</p>
<pre>doc.supportedTypes() </pre>
<p>The different FreeCAD modules, although they added their object types to FreeCAD, are not automatically loaded in the python console. This is to avoid having a very slow startup. Modules are loaded only when you need them. So, for example, to explore what's inside the Part module:
</p>
<pre>import Part
Part. </pre>
<p>But we'll talk more about the Part module below.
</p><p>By now, you know a bit more about the different modules of FreeCAD: The core modules (FreeCAD, FreeCADGui), and the workbenches modules (Part, Mesh, Sketcher). The other important modules are the 3d scene module (pivy) and the interface module (pyside), we'll talk about them too below. 
</p><p>Now it's time to explore a bit deeper the important ones, which are the workbench modules.
</p>
<h2><span class="mw-headline" id="Mesh">Mesh</span></h2>
<p><a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Polygon_mesh">Meshes</a> are a very simple kind of 3D objects, used for example by <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/SketchUp">Sketchup</a>, <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Blender_%28software%29">Blender</a> or <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Autodesk_3ds_Max">3D studio Max</a>. They are composed of 3 elements: points (also called vertices), lines (also called edges) and faces. In many applications, FreeCAD included, faces can have only 3 vertices. But of course nothing prevents you from having a bigger plane face made of several coplanar triangles.
</p><p>Meshes are simple, this can be a bad thing, but for many applications such as those mentioned above, it turns to be an advantage, because they are so simple that you can easily have millions of them in a single document. In FreeCAD, though, they have less use, and are mostly there so you can import objects in mesh formats (.stl, .obj) from other applications. It was also used extensively as the main test module in the first month of FreeCAD's life.
</p><p>Mesh objects and FreeCAD objects are different things. You can see the FreeCAD object as a container for a Mesh object (like, we'll see below, for Part objects too). So in order to add a mesh object to FreeCAD, we must first create a FreeCAD object and a Mesh object, then add the Mesh object to the FreeCAD object:
</p>
<pre>import Mesh
mymesh = Mesh.createSphere()
mymesh.
mymesh.Facets
mymesh.Points
 
meshobj = doc.addObject("Mesh::Feature","MyMesh")
meshobj.Mesh = mymesh
doc.recompute() </pre>
<p>This is a standard example, that uses the createSphere() method to automatically create a sphere, but you can very well create custom meshes from scratch, by defining their vertices and faces.
</p><p><a href="Mesh_Scripting.html" title="Mesh Scripting">Read more about mesh scripting...</a>
</p>
<h2><span class="mw-headline" id="Part">Part</span></h2>
<p>The <a href="Part_Module.html" title="Part Module">Part Module</a> is the most powerful module of the whole FreeCAD. It allows to create and manipulate <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Boundary_representation">BRep</a> objects. This kind of object, unlike meshes, can have a wide variety of components. To resume a bit, Brep means Boundary Representation. which means that they are defined by their surfaces, which enclose and define an inner volume. These surface can be a variety of things, such as plane faces or very complex NURBS surfaces. They also carry the concept of volume.
</p><p>The Part module is based on the powerful <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Open_CASCADE_Technology">OpenCasCade</a> library, which allows a wide range of complex operations to be easily performed on those objects, such as boolean operations, filleting, lofts, etc...
</p><p>The Part module works the same way as the Mesh module: You create a FreeCAD object, a Part object, then add the Part object to the FreeCAD object:
</p>
<pre>import Part
myshape = Part.makeSphere(10)
myshape.
myshape.Volume
myshape.Area

shapeobj = doc.addObject("Part::Feature","MyShape")
shapeobj.Shape = myshape
doc.recompute() </pre>
<p>The Part module (like the Mesh module) also has a shortcut that automatically creates a FreeCAD object and add a shape to it, so you can skip the 3 last lines above:
</p>
<pre>Part.show(myshape) </pre>
<p>By exploring the contents of myshape, you will notice many interesting available subcomponents such as Faces, Edges, Vertexes, Solids or Shells, and a wide range of geometry operations such as cut (subtraction), common (intersection) or fuse (union). The <a href="Topological_data_scripting.html" title="Topological data scripting">Topological data scripting</a> page explains all that in detail.
</p><p><a href="Topological_data_scripting.html" title="Topological data scripting">Read more about part scripting...</a>
</p>
<h2><span class="mw-headline" id="Draft">Draft</span></h2>
<p>FreeCAD features many more modules, such as <a href="Sketcher_Workbench.html" title="Sketcher Workbench">Sketcher</a> or <a href="Draft_Module.html" title="Draft Module">Draft</a>, which also create Part objects, but add parameters to it, or even carry a whole new way to handle the Part geometry in them. Our box example above, is a perfect example of parametric object. All you need, to define the box, is to specify a couple of parameters, such as height, width and length. Based on those, the object will automatically calculate its Part shape. FreeCAD allows you to <a href="Scripted_objects.html" title="Scripted objects">create such objects in python</a>.
</p><p>The <a href="Draft_Module.html" title="Draft Module">Draft Module</a> adds a couple of 2D parametric objects types (which are all Part objects) such as lines and circles, and also provides some generic functions that work not only on Draft-made objects, but on any Part object. To explore what is available, simply do:
</p>
<pre>import Draft
Draft.
rec = Draft.makeRectangle(5,2)
mvec = FreeCAD.Vector(4,4,0)
Draft.move(rec,mvec)
Draft.move(box,mvec) </pre>
<h2><span class="mw-headline" id="Interface">Interface</span></h2>
<p>The FreeCAD user interface is made with <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Qt_%28framework%29">Qt</a>, a powerful graphical interface system, responsible for drawing and handling all the controls, menus, toolbars, buttons around the 3D view. Qt provides a module, called PySide, which allows python to access and modify Qt interfaces, such as FreeCAD. Let's try to fiddle with the Qt interface and produce a simple dialog:
</p>
<pre>from PySide import QtGui
QtGui.QMessageBox.information(None,"Apollo program","Houston, we have a problem") </pre>
<p>See that the dialog that appears has the FreeCAD icon in its toolbar, meaning that Qt knows that the order has been issued from inside the FreeCAD application. We can therefore easily directly manipulate any part of the FreeCAD interface.
</p><p>Qt is a very powerful interface system, that allows you to do very complex things, but also has a couple of very easy-to use tools such as the Qt Designer with which you can design dialogs graphically and then add them to the FreeCAD interface with a couple of lines of python.
</p><p><a href="PySide.html" title="PySide">Read more about PySide here...</a>
</p>
<h2><span class="mw-headline" id="Macros">Macros</span></h2>
<p>Now that you have a good understanding of the basics, where are we going to keep our python scripts, and how are we going to launch them easily from FreeCAD? There is an easy mechanism for that, called <a href="Macros.html" title="Macros">Macros</a>. A macro is simply a python script, that can then be added to a toolbar and be launched from a simple mouse click. FreeCAD provides you with a simple text editor (Macro -&gt; Macros -&gt; Create) where you can write or paste scripts. Once it is done, the Tools -&gt; Customize -&gt; Macros allow you to define a button for it, that can be added to toolbars.
</p><p>Now you are ready for more in-depth FreeCAD scripting. Head on to the <a href="https://www.freecadweb.org/wiki/index.php?title=Power_users_hub" title="Power users hub">Power users hub</a>!
</p>

<p><br />
</p>
<div style="clear:both"></div>
</div>



</div>

</div><div class="printfooter">
Online version: "<a dir="ltr" href="https://www.freecadweb.org/wiki/index.php?title=Python_scripting_tutorial/cs&amp;oldid=271133">http://www.freecadweb.org/wiki/index.php?title=Python_scripting_tutorial/cs&amp;oldid=271133</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"></div><div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>

</body></html>